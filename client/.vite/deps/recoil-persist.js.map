{
  "version": 3,
  "sources": ["../../node_modules/recoil-persist/dist/index.js"],
  "sourcesContent": ["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.recoilPersist = void 0;\n/**\n * Recoil module to persist state to storage\n *\n * @param config Optional configuration object\n * @param config.key Used as key in local storage, defaults to `recoil-persist`\n * @param config.storage Local storage to use, defaults to `localStorage`\n */\nconst recoilPersist = (config = {}) => {\n    if (typeof window === 'undefined') {\n        return {\n            persistAtom: () => { },\n        };\n    }\n    const { key = 'recoil-persist', storage = localStorage } = config;\n    const persistAtom = ({ onSet, node, trigger, setSelf }) => {\n        if (trigger === 'get') {\n            const state = getState();\n            if (typeof state.then === 'function') {\n                state.then((s) => {\n                    if (s.hasOwnProperty(node.key)) {\n                        setSelf(s[node.key]);\n                    }\n                });\n            }\n            if (state.hasOwnProperty(node.key)) {\n                setSelf(state[node.key]);\n            }\n        }\n        onSet(async (newValue, _, isReset) => {\n            const state = getState();\n            if (typeof state.then === 'function') {\n                state.then((s) => updateState(newValue, s, node.key, isReset));\n            }\n            else {\n                updateState(newValue, state, node.key, isReset);\n            }\n        });\n    };\n    const updateState = (newValue, state, key, isReset) => {\n        if (isReset) {\n            delete state[key];\n        }\n        else {\n            state[key] = newValue;\n        }\n        setState(state);\n    };\n    const getState = () => {\n        const toParse = storage.getItem(key);\n        if (toParse === null || toParse === undefined) {\n            return {};\n        }\n        if (typeof toParse === 'string') {\n            return parseState(toParse);\n        }\n        if (typeof toParse.then === 'function') {\n            return toParse.then(parseState);\n        }\n        return {};\n    };\n    const parseState = (state) => {\n        if (state === undefined) {\n            return {};\n        }\n        try {\n            return JSON.parse(state);\n        }\n        catch (e) {\n            console.error(e);\n            return {};\n        }\n    };\n    const setState = (state) => {\n        try {\n            if (typeof storage.mergeItem === 'function') {\n                storage.mergeItem(key, JSON.stringify(state));\n            }\n            else {\n                storage.setItem(key, JSON.stringify(state));\n            }\n        }\n        catch (e) {\n            console.error(e);\n        }\n    };\n    return { persistAtom };\n};\nexports.recoilPersist = recoilPersist;\n"],
  "mappings": ";;;;;AAAA;AAAA;AACA,WAAO,eAAe,SAAS,cAAc,EAAE,OAAO,KAAK,CAAC;AAC5D,YAAQ,gBAAgB;AAQxB,QAAM,gBAAgB,CAAC,SAAS,CAAC,MAAM;AACnC,UAAI,OAAO,WAAW,aAAa;AAC/B,eAAO;AAAA,UACH,aAAa,MAAM;AAAA,UAAE;AAAA,QACzB;AAAA,MACJ;AACA,YAAM,EAAE,MAAM,kBAAkB,UAAU,aAAa,IAAI;AAC3D,YAAM,cAAc,CAAC,EAAE,OAAO,MAAM,SAAS,QAAQ,MAAM;AACvD,YAAI,YAAY,OAAO;AACnB,gBAAM,QAAQ,SAAS;AACvB,cAAI,OAAO,MAAM,SAAS,YAAY;AAClC,kBAAM,KAAK,CAAC,MAAM;AACd,kBAAI,EAAE,eAAe,KAAK,GAAG,GAAG;AAC5B,wBAAQ,EAAE,KAAK,GAAG,CAAC;AAAA,cACvB;AAAA,YACJ,CAAC;AAAA,UACL;AACA,cAAI,MAAM,eAAe,KAAK,GAAG,GAAG;AAChC,oBAAQ,MAAM,KAAK,GAAG,CAAC;AAAA,UAC3B;AAAA,QACJ;AACA,cAAM,OAAO,UAAU,GAAG,YAAY;AAClC,gBAAM,QAAQ,SAAS;AACvB,cAAI,OAAO,MAAM,SAAS,YAAY;AAClC,kBAAM,KAAK,CAAC,MAAM,YAAY,UAAU,GAAG,KAAK,KAAK,OAAO,CAAC;AAAA,UACjE,OACK;AACD,wBAAY,UAAU,OAAO,KAAK,KAAK,OAAO;AAAA,UAClD;AAAA,QACJ,CAAC;AAAA,MACL;AACA,YAAM,cAAc,CAAC,UAAU,OAAOA,MAAK,YAAY;AACnD,YAAI,SAAS;AACT,iBAAO,MAAMA,IAAG;AAAA,QACpB,OACK;AACD,gBAAMA,IAAG,IAAI;AAAA,QACjB;AACA,iBAAS,KAAK;AAAA,MAClB;AACA,YAAM,WAAW,MAAM;AACnB,cAAM,UAAU,QAAQ,QAAQ,GAAG;AACnC,YAAI,YAAY,QAAQ,YAAY,QAAW;AAC3C,iBAAO,CAAC;AAAA,QACZ;AACA,YAAI,OAAO,YAAY,UAAU;AAC7B,iBAAO,WAAW,OAAO;AAAA,QAC7B;AACA,YAAI,OAAO,QAAQ,SAAS,YAAY;AACpC,iBAAO,QAAQ,KAAK,UAAU;AAAA,QAClC;AACA,eAAO,CAAC;AAAA,MACZ;AACA,YAAM,aAAa,CAAC,UAAU;AAC1B,YAAI,UAAU,QAAW;AACrB,iBAAO,CAAC;AAAA,QACZ;AACA,YAAI;AACA,iBAAO,KAAK,MAAM,KAAK;AAAA,QAC3B,SACO,GAAP;AACI,kBAAQ,MAAM,CAAC;AACf,iBAAO,CAAC;AAAA,QACZ;AAAA,MACJ;AACA,YAAM,WAAW,CAAC,UAAU;AACxB,YAAI;AACA,cAAI,OAAO,QAAQ,cAAc,YAAY;AACzC,oBAAQ,UAAU,KAAK,KAAK,UAAU,KAAK,CAAC;AAAA,UAChD,OACK;AACD,oBAAQ,QAAQ,KAAK,KAAK,UAAU,KAAK,CAAC;AAAA,UAC9C;AAAA,QACJ,SACO,GAAP;AACI,kBAAQ,MAAM,CAAC;AAAA,QACnB;AAAA,MACJ;AACA,aAAO,EAAE,YAAY;AAAA,IACzB;AACA,YAAQ,gBAAgB;AAAA;AAAA;",
  "names": ["key"]
}
